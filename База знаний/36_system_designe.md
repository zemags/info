#### Горизонтальное масштабирование
 - дешевые сервера лучше(горизонтальная масштабирование), чем дорогие(вертикальное масштибрование)
недостатки:
 - сервера не должны хранить какое либо состояние(сессии изображения пользователей)
 - сессии и прочее должны хранится отдельно в БД
 - кэширующие сервера должны обрабатывать большство запросов

#### nosql колоночные БД
 - в качестве базисной единицы данных = колонка
 - колонка может быть сгруппирована в семейную колонку (аналогия таблиц в SQL)
 - очень доступны
 - очень хорошо масштабируются
 - часто юзают для обработка больших массивов данных

#### мастер - раб репликация (масштабирование)
 - мастер читает и пишет
 - реплецирует на одного и более рабов, рабы только читают
 - если мастер упал, то система только в чтение
 - можно поднять раба до мастера

#### частичная консистенция
 - в системах DNS и EMAIL
 - после записи, чтение вернет вполне себе последние данные, за несколько миллисекунд
 - для системы с высокой доступностью

#### матсер - мастер репликация (масштабирвоание)
 - оба мастера читают\пишут координируя запись между собой
 - если мастер упал, то система работает с другими мастерами
- недостатки:
 - есть риск потери данных если мастер упадет (на другие ноды данные не дойдут)
 - записи повторяются на реплики с которых происходит чтение, если операций много, то чтение может нарушится
 - чем больше рабов чтения, тем больше задержка репликации
 - репликации требуют большего кол - ва железа,сложность системы

#### nosql ключ - значение хранилище (hash table)
 - сложность операции О(1)
 - может поддерживать ключи в лексическом порядке
 - может хранить различные мета - данные
 - высокая производительность
 - часто юзают для простых моделей\быстро изменяющихся данных
 - базис для более сложных систем как файловая БД, или графовые БД

#### BASE в NOSQL
 - для определения свойств NOSQL
 - Basically available  -  гарантирует доступность
 - Soft state  -  состояние системы может измениться даже без выполнения каких либо действий
 - Eventual consistency  -  система станет консистентной на некоторый период в течении которого она не будет получать какой либо ввод

#### партиции
- разбивка таблицы и загрузка горячих данных в память для более быстрого доступа

#### балансировщик нагрузки
- распределяет входящий трафик между сервисами\приложениями\БД
- хорош,когда нужно:
   - тормознуть обработку запросу не работающим сервером
   - защитить ресурсы от чрезмерной нагрузки
   - избежать единой точки отказа
   - расшифровка входящих запросов и шифровка ответов
   - хранит сессии, куки, направляет одного и того же юзера на тот же сервер

#### опасность синхронных вызово между сервисами
- сталкиваешься с эффектом мутипликации времени простоя
- время простоя системы = произведение простоя компонент системы

#### как балансиры направляют трафик
- случайно
- наименее загруженный
- сессии\куки
- round robin
- по слою 4 модели OSI
- по слою 7 модели OSI

#### NOSQL
 - это коллекции сущностей представленных в виде ключ -  значение хранилище\документов хранилище\широко колоночном хранилище
 - данные денормализованы
 - объедения на уровне приложения
 - большинство NOSQL бд не поддерживают ACID

#### сильная консистенция
- сразу после записи можно прочесть самые последние данные
 - запись идет синхронно, это может влиять на доступность системы
 - реплика по всей системы синхронно
 - используется в системах с relation data base models systems, где нужны транзаакции короче

#### недостатки реверс прокси сервера
 - увеличивает сложность системы
 - один сервер создает единую точку отказа, решение этой пробы увеличивает сложность системы

#### шардинг\сегментация
 - это распределение данных по раличным БД
 - чем больше данных тем больше шардов
 - похоже на федерализацию
 - данные распределяются по кол - ву и сходим параметрам нежели по их доменной значимости
  - например разбить пользователей по именам или географии
- недостатки:
 - сложная логика\запросы
 - неравномерное распределение данных в плане частоты их чтения
 - балансировка добавляет сложности
 - чтение из нескольких шардов сложнее

#### Децетрализованное управление данными
 - предлагает делить сложную предметную область на несколько контекстов и мапить отношения между ними.
 - каждому сервису своя бд (подход polyglot persistence)

#### отказоустойчивость (активный - пассивный, активный - аквтивный) или master - slave\master - master
- активный - пассивный между активным и пассивным серверами отправка пульса, если
   - пульс прекращается то пассивный берет на себе обязанности активного сервера.
   - пассивный сервер может ожидать в горячем\холодном состоянии
   - время простоя зависит от того как быстро пассивный готов начать работу
   - пассивный может убить активный путем команды shoot the other node in the nead
- активный - активный, оба работают распределяют трафик между собой
- недостатки:
   - отказоусточивость требует большего кол - ва железа, добавляет сложности
   - есть потенциальная возможность потерять данные, если данные не успели реплецироваться

#### nosql графовая БД
 - каждая нода это запись, а ребра - связи
 - оптимизированы для представления комплексных связей между множеством ключей
 - часто имеют высокую производительность работая с данными имеющие множество связей, например как соцсети

#### денормализация
 - это попытка улучшить чтение ценой производительности записи
 - избыточные копии данных записываются в несколько таблиц, для уменьшение сложных объединений
 - облегчает после распределения данных подходом федерализации и шардинга
- недостатки:
 - дупликация данных
 - ограничения могут помочь с излишними копиями, но это усложнит систему
 - оправдывает себе только в системах с большим кол - вом операций чтения

#### задержка и пропускная способность
 - задержка это время для выполнения действия\ результата
 - пропускная способность это кол - во операций\результатов в ед.времени
 - нужно делать максимальную пропускную способность при допустимой задержке

#### консистентность доступность устойчивость к разделению
- консистентность  -  каждое чтение вернет свежие данные\ошибку
- доступность  -  каждый запрос вернет результат, без гарантий что данные свежие
- устойчивость к разделению  -  система должна работать если даже потеряет ресурсы\узлы\ошибки и другое
- КУ  -  консистентность + устойчивое разделение = в такой система если ждать результат от ноды можно получить таймаут. Ок для систем где нужна атомарность операций
- ДУ = ответы наиболее свежие доступные ноде, но в целом могут быть не свежи.

#### недостатки CDN
 - контент может устаревать, если он обновляется раньше удаления кеша
 - необходимость изменения ссылок на новый контет

#### nosql файловая\документная БД
- key - value (значение это документ)
 - строются вокруг документов формата XML. JSON, binary..
 - документы могут быть организованы в коллекции теги метадату директории
 - высокая гибкость, юзают где данные часто меняются
 - mongodb, couchdb похож на sql язык запросов

#### ACID в БД
- atomicity  -  транзакция выполняется целиком или не выполняется вообще
- consistency  -  транзакция перевод БД из одного стабильного состояния в другое
- isolation  -  выполнение транзакции поочередно или асинхронно должны приводить БД к одному и тому же состояния
- durability  -  после выполнения транзакций состояния БД не меняется

#### sql тюнинг
 - важно тестить БД и находить узкие места
 - benchmark  -  эмуляция высокой нагрузки и тестом производительности
 - profile  -  профилирование работы БД на нахождения проблем
хорошо продуманная схема:
 - mysql запись на диск в непрерывном режиме
 - char вместо varchar для полей с фиксированным значением (обеспечивает быстрый рандомный доступ, в то время как varchar необходимо найти конец строки, чтобы двигаться к следующей)
 - использовать TEXT для больших блоков текста, позволяет делать булевый поиск, позволяет хранить указатель на диске который определяет блок текста
 - INT для больших чисел  -  4 млрд
 - DECIMAL для денежных единиц
 - не стоит хранить большие BLOBS лучше хранить локацию к объекту
 - установка NOT NULL ограничений для улучшения поиска
 - запрос колонок (select, group by, order by, join) может быть быстрее с индексами
 - индексы  -  это самобалансирующиеся В - деревья, которые хранят данные отсортированными и позволяют производить поиск, поочередный доступ, вставку и удаление логарифмической сложности
 - скорость запись может уменьшаться изза индексов так как их нужно обновлять
 - при загрузке больших данных, решение с отключением индексов на время загрузки и последующие обновлением индексов может уменьшить время записи по сравнению с постоянной индексацией по мере записи

#### push CDN
 - получает новый контент каждый раз как оно обновляется на сервере.(разраб обновляет,либо по триггеру)
 - для сайтов в маленьким трафиком,или где контект меняется редко

#### cdn  -  content delivery network
- глобальная и распределенная сеть прокси серверов, предоставляет контент по всему миру.
 - как правило хранить статичные файлы html css js
плюсы:
 - данные летят с ближайшего cdn сервера
 - сервер с приложением не тратит усилия на обработку таких запросов

#### недостатки балансировщиков
 - если слабые или конфиг неверный то это узкое место
 - повышается сложность системы, но уменьшают риски
 - один балансир это единственная точка отказа всей системы, конфиг нескольких это сложность системы

#### pull CDN
 - выкачивает новые данные при первом обращении пользователя. первый запрос медленные, потом уже и кэша
 - TTL  -  time to live как долго будет в кэшэ контент.
 - для сайтов с большим трафиком, т.к. кол - во обращений к закешированным данным гораздо больше

#### федерализация
 - это разбиение БД по ее функциям (иметь вместо монолита БД, несколько БД под различные данные)
 - это улучшит чтение и запись, меньше сложность репликации
недостатки:
 - неэффективно если схема таблиц слишком большая
 - нужно обновлять логику приложения по которой идет запись в БДхи
 - работа с двумя и более БД сложнее
 -  плюс сложность и железо к системе

#### реверс прокси сервер
 - централизует внутренние сервисы, интерфейс наружу
 - безопасность прячет инфу о бекенд серверах
 - блокирует айпи адреса
 - ограничивает кол - во соединений на клиента
 - масштабируемость и гибкость
 - клиенты видят только прокси, внутренний конфиг может быть любой
 - ssl терминация  -  расшифровка входящих и шифровка исходящих пакетов в одном месте
 - сжатие ответов
 - кеширование
 - статистический контент html\css\js\фото\видео\прочее

#### слабая консистенция
 - подходит для использования в реал - тайм, например VoIP, видео чаты, мультиплеерные игры.
 - если говоришь по телефону, и потеряли связь на время, то не услышишь что было сказано в этот момент
 - такой подход в системах как memcached

#### производительность и масштабируемость
 - сервис масштабируем если производительность растет пропорционально добавляемым ресурсам.
 - увеличение проихводительнсти увеличт объем данных
 - если проблема с производительностью то система медленна для одного чела
 - если проблема с масштабируемостью, то проблемы для многих челов, для одного ок
